<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EquipLink Marketplace</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header>
        <h1>EquipLink</h1>
        <nav>
            <button id="nav-catalog" class="nav-button active">Catálogo</button>
            <button id="nav-auth" class="nav-button">Iniciar Sesión / Registrar</button>
            <button id="nav-admin-dashboard" class="nav-button hidden">Panel Admin</button>
            <button id="nav-provider-dashboard" class="nav-button hidden">Panel Proveedor</button>
            <button id="nav-client-dashboard" class="nav-button hidden">Panel Cliente</button>
            <button id="nav-logout" class="nav-button hidden">Cerrar Sesión</button>
        </nav>
    </header>

    <main>
        <div id="loading-spinner" class="spinner hidden"></div>
        <div id="error-message" class="error-container hidden"></div>

        <!-- Catálogo de Equipos -->
        <section id="catalog-page" class="page">
            <h2>Catálogo de Equipos</h2>
            
            <!-- NUEVO: Filtros de búsqueda -->
            <div id="search-filters" class="filters-container">
                <h3>Filtros de búsqueda</h3>
                <div class="filter-row">
                    <input type="text" id="filter-name" placeholder="Buscar por nombre...">
                    <select id="filter-type">
                        <option value="">Todos los tipos</option>
                    </select>
                    <select id="filter-state">
                        <option value="">Todos los estados</option>
                    </select>
                    <select id="filter-company">
                        <option value="">Todas las empresas</option>
                    </select>
                    <select id="filter-brand">
                        <option value="">Todas las marcas</option>
                    </select>
                    <button id="apply-filters-btn" class="btn">Buscar</button>
                    <button id="clear-filters-btn" class="btn">Limpiar</button>
                </div>
            </div>
            
            <div id="equipment-list" class="grid-container">
                <!-- Los equipos se cargarán aquí -->
            </div>
        </section>

        <!-- Detalle de Equipo -->
        <section id="equipment-detail-page" class="page hidden">
            <button id="back-to-catalog" class="btn">← Volver al Catálogo</button>
            <div id="equipment-detail-content">
                <!-- Detalles del equipo se cargarán aquí -->
            </div>
            <div id="reviews-section">
                <h3>Reseñas</h3>
                <div id="reviews-list"></div>
                <h4>Dejar una Reseña</h4>
                <div id="review-form-container" class="hidden">
                    <input type="number" id="review-star-value" min="1" max="5" placeholder="Estrellas (1-5)" required>
                    <textarea id="review-body" placeholder="Escribe tu reseña aquí..."></textarea>
                    <button id="submit-review-btn" class="btn">Enviar Reseña</button>
                </div>
                <p id="review-login-prompt" class="hidden">Debes iniciar sesión como cliente para dejar una reseña.</p>
            </div>
        </section>

        <!-- Página de Login / Registro -->
        <section id="auth-page" class="page hidden">
            <h2>Iniciar Sesión / Registrar</h2>
            <div class="auth-forms">
                <div class="auth-form">
                    <h3>Iniciar Sesión</h3>
                    <form id="login-form">
                        <input type="email" id="login-email" placeholder="Email" required>
                        <input type="password" id="login-password" placeholder="Contraseña" required>
                        <button type="submit" class="btn">Iniciar Sesión</button>
                    </form>
                </div>
                <div class="auth-form">
                    <h3>Registrar</h3>
                    <form id="register-form">
                        <input type="text" id="register-fullname" placeholder="Nombre Completo" required>
                        <input type="email" id="register-email" placeholder="Email" required>
                        <input type="password" id="register-password" placeholder="Contraseña" required>
                        <select id="register-usertype" required>
                            <option value="">Selecciona tipo de usuario</option>
                            <option value="cliente">Cliente</option>
                            <option value="proveedor">Proveedor</option>
                        </select>
                        <!-- MODIFICADO: Campos para proveedor - ahora solo selecciona empresa -->
                        <div id="provider-fields" class="hidden">
                            <h4>Selecciona tu Empresa</h4>
                            <select id="provider-company-id" required>
                                <option value="">Selecciona una empresa</option>
                            </select>
                        </div>
                        <button type="submit" class="btn">Registrar</button>
                    </form>
                </div>
            </div>
        </section>

        <!-- NUEVO: Panel de Administrador -->
        <section id="admin-dashboard-page" class="page hidden">
            <h2>Panel de Administrador</h2>
            <div class="dashboard-tabs">
                <button class="tab-button active" data-tab="admin-companies">Empresas</button>
                <button class="tab-button" data-tab="admin-brands">Marcas</button>
            </div>

            <div id="admin-companies-tab" class="tab-content">
                <h3>Gestión de Empresas</h3>
                <button id="add-company-btn" class="btn">Añadir Nueva Empresa</button>
                <div id="companies-list" class="list-container"></div>
            </div>

            <div id="admin-brands-tab" class="tab-content hidden">
                <h3>Gestión de Marcas</h3>
                <button id="add-brand-btn" class="btn">Añadir Nueva Marca</button>
                <div id="brands-list" class="list-container"></div>
            </div>
        </section>

        <!-- Panel de Proveedor -->
        <section id="provider-dashboard-page" class="page hidden">
            <h2>Panel de Proveedor</h2>
            <div class="dashboard-tabs">
                <button class="tab-button active" data-tab="provider-equipment">Mis Equipos</button>
                <button class="tab-button" data-tab="provider-company">Mi Empresa</button>
            </div>

            <div id="provider-equipment-tab" class="tab-content">
                <h3>Mis Equipos</h3>
                <button id="add-equipment-btn" class="btn">Añadir Nuevo Equipo</button>
                <div id="my-equipment-list" class="grid-container"></div>
            </div>

            <div id="provider-company-tab" class="tab-content hidden">
                <h3>Información de mi Empresa</h3>
                <div id="company-details-view">
                    <p><strong>Nombre:</strong> <span id="view-company-name"></span></p>
                    <p><strong>Email:</strong> <span id="view-company-email"></span></p>
                    <p><strong>Teléfono:</strong> <span id="view-company-phone"></span></p>
                    <p><strong>Dirección:</strong> <span id="view-company-address"></span></p>
                    <p><strong>Web:</strong> <span id="view-company-website"></span></p>
                    <h4>Marcas asociadas</h4>
                    <div id="company-brands-list"></div>
                </div>
            </div>
        </section>

        <!-- Panel de Cliente -->
        <section id="client-dashboard-page" class="page hidden">
            <h2>Panel de Cliente</h2>
            <div class="dashboard-tabs">
                <button class="tab-button active" data-tab="client-favorites">Mis Favoritos</button>
                <button class="tab-button" data-tab="client-reviews">Mis Reseñas</button>
            </div>
            <div id="client-favorites-tab" class="tab-content">
                <h3>Mis Equipos Favoritos</h3>
                <div id="my-favorites-list" class="grid-container"></div>
            </div>
            <div id="client-reviews-tab" class="tab-content hidden">
                <h3>Mis Reseñas</h3>
                <div id="my-reviews-list"></div>
            </div>
        </section>
    </main>

    <!-- Modals (pop-ups) -->

    <!-- Modal para Añadir/Editar Empresa (NUEVO) -->
    <div id="company-modal" class="modal hidden">
        <div class="modal-content">
            <span class="close-button">×</span>
            <h3 id="company-modal-title">Añadir Empresa</h3>
            <form id="company-form">
                <input type="hidden" id="company-id">
                <input type="text" id="company-name" placeholder="Nombre de la Empresa" required>
                <input type="email" id="company-email" placeholder="Email de la Empresa">
                <input type="text" id="company-phone" placeholder="Teléfono">
                <input type="text" id="company-address" placeholder="Dirección">
                <input type="url" id="company-website" placeholder="Sitio Web">
                <button type="submit" class="btn">Guardar Empresa</button>
            </form>
        </div>
    </div>

    <!-- Modal para Gestionar Marcas de Empresa (NUEVO) -->
    <div id="manage-company-brands-modal" class="modal hidden">
        <div class="modal-content">
            <span class="close-button">×</span>
            <h3>Gestionar Marcas de <span id="manage-brands-company-name"></span></h3>
            <input type="hidden" id="manage-brands-company-id">
            
            <h4>Marcas Asociadas</h4>
            <div id="manage-brands-list" class="list-container"></div>
            
            <h4>Asociar Nueva Marca</h4>
            <form id="associate-brand-form">
                <select id="select-brand-to-associate" required>
                    <option value="">Selecciona una marca</option>
                </select>
                <button type="submit" class="btn">Asociar Marca</button>
            </form>
        </div>
    </div>

    <!-- Modal para Añadir/Editar Equipo -->
    <div id="equipment-modal" class="modal hidden">
        <div class="modal-content">
            <span class="close-button">×</span>
            <h3 id="equipment-modal-title">Añadir Equipo</h3>
            <form id="equipment-form">
                <input type="hidden" id="equipment-id">
                <input type="text" id="equipment-name" placeholder="Nombre del Equipo" required>
                <textarea id="equipment-description" placeholder="Descripción"></textarea>
                <input type="number" id="equipment-price" step="0.01" placeholder="Precio" required>
                <input type="url" id="equipment-url-image" placeholder="URL de la Imagen del Equipo"> 
                <select id="equipment-type-id" required>
                    <option value="">Selecciona Tipo de Equipo</option>
                </select>
                <select id="equipment-state-id" required>
                    <option value="">Selecciona Estado del Equipo</option>
                </select>
                <select id="equipment-brand-id" required>
                    <option value="">Selecciona Marca</option>
                </select>
                <button type="submit" class="btn">Guardar Equipo</button>
            </form>
        </div>
    </div>

    <!-- Modal para Añadir/Editar Marca -->
    <div id="brand-modal" class="modal hidden">
        <div class="modal-content">
            <span class="close-button">×</span>
            <h3 id="brand-modal-title">Añadir Marca</h3>
            <form id="brand-form">
                <input type="hidden" id="brand-id">
                <input type="text" id="brand-name" placeholder="Nombre de la Marca" required>
                <button type="submit" class="btn">Guardar Marca</button>
            </form>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>